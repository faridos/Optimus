{% extends "FrontOfficeOptimusBundle::layout.html.twig" %}
{% block body %}
    <div id="wrapper">
        <div id="mapView" class="mob-min"><div class="mapPlaceholder"><span class="fa fa-spin fa-spinner"></span> Loading map...</div> </div>
        <div id="content" class="mob-max" style="height: 356px;">
            <div class="col-lg-12"><div class="row mb20">
                </div>
                {% for event in events %}
                    <div class="col-lg-12">
                        <div class="notificationsWidget">
                            <div class="singleTop whiteBg">
                                <div class="notificationsWidget">
                                    <div class="notification">
                                        <div class="time green">
                                           <a href="{{ path('show_event', { 'id' : event.id }) }}" class="timeBody hidden-xs">{{ event.titre }}</a>
                                            <div class="timeArrow hidden-xs"><span class="fa fa-caret-right"></span></div>
                                            <div class="indicator"><span class="fa fa-circle-o"></span></div>
                                            <div class="notifyArrow"><span class="fa fa-caret-left"></span></div>
                                        </div>
                                        <div class="notifyContent">
                                            <div class="notifyBody">
                                                <a href="{{ path('show_profil', {'id' : event.createur.id}) }}"> <img class="avatar pull-left" src="{{ asset(event.createur.WebPath)}}" alt="avatar"></a>
                                                <div class="notify pull-left">
                                                    <div class="name">{{ event.createur.prenom }} {{ event.createur.nom }}<span class="label label-green visible-xs">Nom d'évenement</span></div>
                                                    <div class="info">
                                                        <div class="address">{{ event.lieu }}</div>
                                                        <div class="title">Date début :{{ event.dateDebut|date('d/m/Y à H:i')}}</div><div class="title">Date de fin :{{ event.dateFin|date('d/m/Y à H:i') }}</div>
                                                        <div class="title">Nombre de places: {{ event.nbrPlaces }} </div>
                                                        <div class="title">Prix: {{ event.frais }} &euro;</div>
                                                        <div class="title">Déscription: {{event.description|raw}}</div>
                                                    </div>  
                                                    <div class="buttonsWrapper pb20">
                                                        <a href="#" class="btn btn-icon btn-round btn-o btn-facebook">
                                                            <span class="fa fa-facebook"></span>
                                                        </a> 
                                                        <a href="#" class="btn btn-icon btn-round btn-o btn-twitter">
                                                            <span class="fa fa-twitter"></span>
                                                        </a> 
                                                        <a href="#" class="btn btn-icon btn-round btn-o btn-google">
                                                            <span class="fa fa-google-plus"></span>
                                                        </a> 
                                                        <a href="#" class="btn btn-icon btn-round btn-o btn-pinterest">
                                                            <span class="fa fa-pinterest"></span>
                                                        </a>
                                                        {% if event.createur != app.user %} 
                                                            <a class="btn btn-round btn-success" href="#" data-toggle="button" style="
                                                               background-color: #c02100;
                                                               border-color: #ccc;">
                                                                <span class="fa fa-trophy state"></span> <span class="state">Participer</span>
                                                                <span class="fa fa-trophy state-active"></span> <span class="state-active">Annuler la participation</span>
                                                            </a>
                                                        {% endif %}
                                                    </div>

                                                </div>
                                                <div class="clearfix"></div>
                                            </div>
                                        </div>
                                        <div class="clearfix"></div>
                                    </div>
                                </div>
                                <ul class="commentsWidget scrollbar" > 
                                    <div class="comment">
                                        <div class="commentAvatar">
                                            <img class="avatar" src="images/avatar-3.png" alt="avatar">
                                            <div class="commentArrow"><span class="fa fa-caret-left"></span></div>
                                        </div>
                                        <div class="commentContent">
                                            <div class="commentName">Foulen ben foulen</div><div class="commentTime" style="
                                                                                                 margin-left: 10px;
                                                                                                 "><span class="icon-clock"></span> 1 day ago</div><br>
                                            <div class="commentBody">celui la est un evenement trop génial , merci pour le partager!</div>

                                        </div>
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="comment">
                                        <div class="commentAvatar">
                                            <img class="avatar" src="images/avatar-3.png" alt="avatar">
                                            <div class="commentArrow"><span class="fa fa-caret-left"></span></div>
                                        </div>
                                        <div class="commentContent">
                                            <div class="commentName">Foulen ben foulen</div><div class="commentTime" style="
                                                                                                 margin-left: 10px;
                                                                                                 "><span class="icon-clock"></span> 1 day ago</div><br>
                                            <div class="commentBody">celui la est un evenement trop génial , merci pour le partager!</div>
                                        </div>
                                        <div class="clearfix"></div>
                                    </div>
                                </ul>
                                <div class="commentsWidgetForm">
                                    <div class="cfAvatar">
                                        <img class="avatar" src="images/avatar-1.png" alt="avatar">
                                    </div>
                                    <form class="commentsForm">
                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="Write a comment...">
                                            <span class="input-group-btn"><a class="btn btn-green">Post</a></span>
                                        </div>
                                    </form>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
                <div class="loader"> <img src="{{asset('template/images/ajax-loader(2).gif') }}"></div>
            </div>
        </div>
        <!--- baniere publicitaire ****************************************************  -->
        <div class="puboptimus">
            <img src="{{ asset('template/images/banniere-pub.jpg') }}" class="banoptimus">
        </div>
        <!--- fin baniere publicitaire ****************************************************  --> 
        <div class="clearfix"></div>
    </div>
   
    <!-- Header -->
{% endblock %} 
{% block javascriptfils %}
    <script>
        
(function($) {
    "use strict";
    // Custom options for map
   
  $.ajax({
                                    url:    Routing.generate('user_coordonne', { lng: pos.D, lat: pos.k }),
                                            type: 'POST',
                                            data: null,
                                            contentType: "application/json; charset=ISO-8859-4",
                                            beforeSend: function () {
                                            },
                                            success: function () {
                                            },
                                            error: function () {
                                            }
                                    });

     var infobox = new InfoBox({
    disableAutoPan: false,
            maxWidth: 202,
            pixelOffset: new google.maps.Size( - 101, - 285),
            zIndex: null,
            boxStyle: {
            background: "url('../template/images/infobox-bg.png') no-repeat",
                    opacity: 1,
                    width: "202px",
                    height: "245px"
            },
            closeBoxMargin: "28px 26px 0px 0px",
            closeBoxURL: "",
            infoBoxClearance: new google.maps.Size(1, 1),
            pane: "floatPane",
            enableEventPropagation: false
    });
      

        {% for event in eventsMap %}

                            var myLatLng = new google.maps.LatLng({{event.lat}}, {{event.lng}});
                            
                            var marker_{{ event.id}} = new google.maps.Marker({
                            position: myLatLng,
                            map: map,
                            icon: new google.maps.MarkerImage('../template/images/marker-green.png'),
                            draggable: false,
                            animation: google.maps.Animation.DROP,
                            title: "Cliquez pour voir aperçu"
                            });
                                    
                            var contenuInfoBulle_{{ event.id}} = '<div class="infoW">' +
                            '<div class="propImg">' +
                            '<img src="../template/images/prop/1-1-thmb.png">' +
                            '<div class="propBg">' +
                            '<div class="propPrice">{{event.frais}} &euro;</div>' +
                            '<div class="propType">{{event.type.nom}}</div>' +
                            '</div>' +
                            '</div>' +
                            '<div class="paWrapper">' +
                            '<div class="propTitle">{{event.titre}}</div>' +
                            '<div class="propAddress">{{event.lieu}}</div>' +
                            '</div>' +
                            '<div class="propRating">' +
                            '<span class="fa fa-star"></span>' +
                            '<span class="fa fa-star"></span>' +
                            '<span class="fa fa-star"></span>' +
                            '<span class="fa fa-star"></span>' +
                            '<span class="fa fa-star-o"></span>' +
                            '</div>' +
                            '<div class="clearfix"></div>' +
                            '<div class="infoButtons">' +
                            '<a class="btn btn-sm btn-round btn-gray btn-o closeInfo">fermer</a>' +
                            '<a href="{{ path('show_event',{'id':event.id} )}}" class="btn btn-sm btn-round btn-green viewInfo">Voir</a>' +
                            '</div>' +
                            '</div>';
                                    
                            google.maps.event.addListener(marker_{{ event.id}}, 'click', function() {

                                infobox.setContent(contenuInfoBulle_{{ event.id}});
                                infobox.open(map, marker_{{ event.id}});
                            });
                            $(document).on('click', '.closeInfo', function() {
                                infobox.open(null, null);
                            });
        {% endfor %}
   




   
})(jQuery);
    </script>
{% endblock %}
