{% extends "FrontOfficeOptimusBundle::layout.html.twig" %}
{% block body %}
    <div id="wrapper">
        <div id="mapView" class="mob-min"><div class="mapPlaceholder"><span class="fa fa-spin fa-spinner"></span> Loading map...</div> </div>
        <div id="content" class="mob-max" >
            <div class="col-lg-12"><div class="row mb20">
                </div>
                <div class="row">
                    <form action="{{ path("club_update",{'id': club.id }) }}" {{ form_enctype(form) }} method="post" >
                        {{ form_errors(form) }}
                        <div class="col-xs-12 ">
                            <div class="panel panel-default">
                                <div class="panel-heading optimus"> <span class="navLabel">Modifier Club</span></div>
                                <div class="panel-body">
                                    <div class="form-group col-xs-6">
                                        {{ form_widget(form.nom) }}
                                    </div>
                                    <div class="form-group col-xs-6">
                                        {{ form_widget(form.discpline) }}
                                    </div>
                                    <div class="form-group col-xs-6">
                                        <div class="input-group search-optimus">
                                            {{ form_widget(form.fraisAdhesion) }}
                                            <div class="input-group-addon round ">â‚¬</div>
                                        </div>
                                    </div> 
                                    <div class="form-group col-xs-6">
                                        {{ form_widget(form.dateCreation) }}
                                    </div>
                                    <div class="form-group col-xs-8 col-xs-offset-2">
                                        {{ form_widget(form.description) }}
                                    </div> 
                                </div>
                            </div>
                        </div> 
                        <div class="col-xs-12 ">
                            <div class="panel panel-default">
                                <div class="panel-heading optimus">veuiller choisir l'emplacement du club dans la map</div><div class="panel-body">
                                    <div class="form-group col-xs-12">
                                        {{ form_widget(form.adresse, { 'id': 'adresse' } ) }}
                                    </div>
                                    <div class="form-group col-xs-6">
                                        {{ form_widget(form.lat, { 'id': 'lat_id' }) }}
                                    </div>
                                    <div class="form-group col-xs-6">
                                        {{ form_widget(form.lng, { 'id': 'lng_id' }) }}
                                    </div><div class="description">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center">
                            <button type="submit" value="Submit" class="btn btn-round btn-green">Modifier</button>
                            <a href="{{ path('show_club', {'id': club.id}) }}" class="btn btn-round btn-green">Annuler</a>
                        </div>
                        {{ form_widget(form._token) }}
                    </form>
                </div>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
{% endblock %}
{% block javascriptfils %}
    <script>
        var myLatLng = new google.maps.LatLng({{club.lat}}, {{club.lng}});
        var marker = new google.maps.Marker({
            position: myLatLng,
        });
        placeMarker(myLatLng);
        var markerClub;
        var geocoder;
        geocoder = new google.maps.Geocoder();
        google.maps.event.addListener(map, 'click', function(event) {
            document.getElementById('lat_id').value = event.latLng.lat();
            document.getElementById('lng_id').value = event.latLng.lng();
            //latlng = event.latLng;
            var latlng = new google.maps.LatLng(event.latLng.lat(), event.latLng.lng());
            //latlng = event.latLng;
            geocoder.geocode({
                'latLng': latlng
            }, function(results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    if (results[0]) {
                        document.getElementById('adresse').value = results[0].formatted_address;
                        placeMarker(event.latLng);
                    } else {
                        alert('No results found');
                    }
                } else {
                    alert('Geocoder failed due to: ' + status);
                }
            });
        });
        function placeMarker(location) {
            if (markerClub === undefined) {
                markerClub = new google.maps.Marker({
                    position: location,
                    map: map,
                    draggable: true,
                    animation: google.maps.Animation.DROP,
                });
                markerClub.setIcon('/Optimus/web/template/images/marker-green.png');
            }
            else {
                markerClub.setPosition(location);
            }
        }
    </script>
{% endblock %}